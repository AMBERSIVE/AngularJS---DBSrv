!function(a,b,c){"use strict";angular.module("ambersive.db",[]),angular.module("ambersive.db").factory("authenticationInjector",["$injector","$q","$log","$dbSettings","$timeout",function(a,b,d,e,f){var g={request:function(a){var f=b.defer(),g=e.storageName,h=e.tokenName,i=e.tokenType,j=null,k=function(a){f.resolve(a)};return(g===c||""===g||0===g.length)&&d.warn("ambersive.db: LocalStorage name is not set"),"undefined"!=typeof Storage?j=localStorage.getItem(g):d.warn("ambersive.db: this browser doesn't support localStorage"),a.headers[h]=i+" "+j,k(a),f.promise},response:function(a){var b=a.headers(),f=e.storageName,g=function(a){if(b[a]!==c&&""!==b[a]){if("undefined"!=typeof Storage)return localStorage.setItem(f,b[a]),b[a];d.warn("ambersive.db: this browser doesn't support localStorage")}},h=g(f);return(h===c||""===h)&&(h=g(f.toLocaleLowerCase())),a}};return g}]),angular.module("ambersive.db").config(["$httpProvider",function(a){a.interceptors.push("authenticationInjector")}]),angular.module("ambersive.db").provider("$dbSettings",[function(){var a="",b="application/json; charset=utf-8;",d="accessToken",e="Bearer",f="Authorization",g={},h=function(a,b){return g[a]=b,g},i=function(a){return g[a]},j=function(b){return a=b},k=function(a){return b=a},l=function(a,b){if(a!==c&&b!==c){switch(a){case"tokenType":e=b;break;default:f=b}return b}},m=function(a){return d=a};return{register:h,setBaseUrl:j,setContentType:k,setTokenAttribute:l,setStorageName:m,$get:function(){return{baseUrl:a,contentType:b,routes:g,route:i,storageName:d,tokenName:f,tokenType:e}}}}]),angular.module("ambersive.db").factory("DB",["$q","$log","$http","$dbSettings",function(a,b,d,e){var f={},g=function(a,b){var d={method:a.toUpperCase()},f=e.baseUrl,g="/",h="";switch(b!==c&&b.baseUrl!==c&&b.baseUrl.length>0&&(f=b.baseUrl),b!==c&&b.url!==c&&(h=b.url),f!==c&&f.length>0&&f.slice(-1)===g?g="":f="/",a){default:d.url=f+g+h}return d.headers={},d.headers["Content-Type"]=e.contentType,b!==c&&b.contentType!==c&&(d.headers["Content-Type"]=b.contentType),d},h=function(b){return{get:function(){var c=a.defer(),e=g("get",b),f=arguments,h=f.length;if(h>0)for(var i=0;h>i;i++)if(angular.isNumber(arguments[i]))e.url+="/"+arguments[i];else{if(!angular.isObject(arguments[i]))continue;var j=0;for(var k in arguments[i]){var l="&";0===j&&(l="?"),e.url+=l+k+"="+arguments[i][k],j++}}return d(e).success(function(a,b,d,e){c.resolve(a,d)}).error(function(a,b,d,e){c.reject(a,d)}),c.promise},getById:function(c){var e=a.defer(),f=g("get",b);return f.url+="/"+c,d(f).success(function(a,b,c,d){e.resolve(a,c)}).error(function(a,b,c,d){e.reject(a,c)}),e.promise},update:function(c,e){var f=a.defer(),h=g("put",b);return h.url+="/"+c,d(h).success(function(a,b,c,d){f.resolve(a)}).error(function(a,b,c,d){f.reject(a)}),f.promise},create:function(c){var e=a.defer(),f=g("post",b);return f.data=c,d(f).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(a)}),e.promise},"delete":function(c){var e=a.defer(),f=g("delete",b);return f.url+="/"+c,d(f).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(a)}),e.promise}}},i=function(){var a,d=null,g=null,i=[];if(arguments.length>0){var j=!1;if(angular.isObject(arguments[0])&&arguments[0].name!==c&&(g=arguments[0].name,arguments[1]!==c&&(j=arguments[1])),angular.isString(arguments[0])&&(g=arguments[0]),f[g]===c&&j===!1){var k=e.route(g);(k===c||angular.isObject(arguments[0]))&&(k=arguments[0]),f[g]=new h(k),i=[],a=e.route(g),a===c&&angular.isObject(arguments[0])&&(a=k),a!==c&&a.except!==c&&(i=a.except),i.length>0&&i.forEach(function(a,b){f[g][a]!==c&&delete f[g][a]})}else j===!0&&(i=[],a=e.route(g),f[g]=new h(a));angular.isObject(arguments[0])&&arguments[0].name!==c&&arguments[0].fnName!==c&&(f[g][arguments[0].fnName]=arguments[0].fn),d=f[g]}else b.warn("Please define a Service");return d};return i}]),angular.module("ambersive.db").factory("REST",["$q","$log","$http","$dbSettings",function(a,b,c,d){var e=function(b){var d=a.defer();return c(b).success(function(a,b,c,e){d.resolve(a,c)}).error(function(a,b,c,e){d.reject(a,c)}),d.promise};return e}])}(window,document,void 0);